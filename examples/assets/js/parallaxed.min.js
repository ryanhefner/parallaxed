!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.parallaxed=t()}(this,function(){"use strict";var e=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();return function(){function l(e){var t=e.selectors,n=e.onEnter,o=void 0===n?function(){}:n,i=e.onExit,s=void 0===i?function(){}:i,r=e.onProgress,c=void 0===r?function(){}:r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.scrollingElement=document.scrollingElement||document.body,this.selectors=t,this._onEnter=o,this._onExit=s,this._onProgress=c,this._onDOMChange=this._onDOMChange.bind(this),this._onScroll=this._onScroll.bind(this),this._onResize=this._onResize.bind(this),window.addEventListener("scroll",this._onScroll),window.addEventListener("resize",this._onResize),this._observer=new MutationObserver(this._onDOMChange),this._observer(document.body,{childList:!0,subtree:!0}),this._checkElements()}return l.prototype.destroy=function(){window.removeEventListener("scroll",this._onScroll),window.removeEventListener("resize",this._onResize),this._observer.disconnect()},l.prototype._refreshActiveElements=function(){var t=[];Array.isArray(this._selectors)?this._selectors.forEach(function(e){t=[].concat(t,[].slice.call(document.querySelectorAll(e)))}):t=[].concat(t,[].slice.call(document.querySelectorAll(this._selectors))),this.activeElements=t.map(function(e){return{element:e,inViewport:!1,progress:0}})},l.prototype._checkElements=function(){var l=this;this.activeElements.forEach(function(e,t,n){var o=e.element,i=o.getBoundingClientRect(),s=window.innerHeight,r=i.top<=s&&0<=i.bottom,c=Math.max(0,Math.min(1,1-i.bottom/(s+i.height)));e.inViewport!==r&&(r?l._onEnter:l._onExit)({element:o,inViewport:r,progress:c});r&&l._onProgress({element:o,inViewport:r,progress:c}),n[t]={element:o,inViewport:r,progress:c}})},l.prototype._onDOMChange=function(e){this._refreshActiveElements(),this._checkElements()},l.prototype._onScroll=function(e){this._checkElements()},l.prototype._onResize=function(e){this._checkElements()},e(l,[{key:"scrollingElement",set:function(e){this._scrollingElement=e},get:function(){return this._scrollingElement}},{key:"selectors",set:function(e){this._selectors=e,this._refreshActiveElements()},get:function(){return this._selectors}}]),l}()});
